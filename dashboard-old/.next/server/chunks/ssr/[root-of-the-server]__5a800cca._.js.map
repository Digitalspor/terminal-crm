{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport path from 'path'\n\nconst dbPath = path.join(process.cwd(), '..', 'data', 'crm.db')\n\nexport function getDb() {\n  return new Database(dbPath, { readonly: true })\n}\n\nexport function getStats() {\n  const db = getDb()\n\n  const stats = db.prepare(`\n    SELECT\n      (SELECT COUNT(*) FROM customers) as total_customers,\n      (SELECT COUNT(*) FROM invoices) as total_invoices,\n      (SELECT COUNT(*) FROM projects) as total_projects,\n      (SELECT SUM(total) FROM invoices WHERE status = 'paid') as total_revenue,\n      (SELECT SUM(total) FROM invoices WHERE status = 'sent') as outstanding,\n      (SELECT COUNT(*) FROM invoices WHERE status <> 'paid' AND due_date < date('now')) as overdue_count\n  `).get() as any\n\n  db.close()\n  return stats\n}\n\nexport function getCustomers(limit = 100) {\n  const db = getDb()\n\n  const customers = db.prepare(`\n    SELECT\n      c.*,\n      (SELECT COUNT(*) FROM invoices WHERE customer_id = c.id) as invoice_count,\n      (SELECT SUM(total) FROM invoices WHERE customer_id = c.id AND status = 'paid') as total_revenue\n    FROM customers c\n    ORDER BY c.name\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return customers\n}\n\nexport function getCustomer(id: string) {\n  const db = getDb()\n\n  const customer = db.prepare(`SELECT * FROM customers WHERE id = ?`).get(id)\n\n  const invoices = db.prepare(`\n    SELECT * FROM invoices\n    WHERE customer_id = ?\n    ORDER BY date DESC\n  `).all(id)\n\n  db.close()\n  return { customer, invoices }\n}\n\nexport function getInvoices(limit = 100) {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    ORDER BY i.date DESC\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return invoices\n}\n\nexport function getOverdueInvoices() {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    WHERE i.status <> 'paid' AND i.due_date < date('now')\n    ORDER BY i.due_date ASC\n  `).all()\n\n  db.close()\n  return invoices\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,MAAM,QAAQ;AAE/C,SAAS;IACd,OAAO,IAAI,sIAAQ,CAAC,QAAQ;QAAE,UAAU;IAAK;AAC/C;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,QAAQ,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ1B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,aAAa,QAAQ,GAAG;IACtC,MAAM,KAAK;IAEX,MAAM,YAAY,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ9B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,YAAY,EAAU;IACpC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,oCAAoC,CAAC,EAAE,GAAG,CAAC;IAExE,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;EAI7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;QAAE;QAAU;IAAS;AAC9B;AAEO,SAAS,YAAY,QAAQ,GAAG;IACrC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/app/%28dashboard%29/invoices/page.tsx"],"sourcesContent":["import { getInvoices } from \"@/lib/db\";\nimport { Badge, Card, Table, TableBody, TableCell, TableHead, TableHeadCell, TableRow } from \"flowbite-react\";\n\nexport const dynamic = \"force-dynamic\";\n\ninterface Invoice {\n  id: string;\n  invoice_number: string;\n  customer_name: string | null;\n  date: string;\n  due_date: string;\n  status: string;\n  total: number;\n}\n\nexport default function InvoicesPage() {\n  const invoices = getInvoices() as Invoice[];\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat(\"nb-NO\", {\n      style: \"currency\",\n      currency: \"NOK\",\n      minimumFractionDigits: 0,\n    }).format(amount / 100);\n  };\n\n  const isOverdue = (invoice: Invoice) => {\n    return invoice.status !== \"paid\" && new Date(invoice.due_date) < new Date();\n  };\n\n  const statusConfig: Record<string, { color: \"gray\" | \"info\" | \"success\" | \"failure\"; label: string }> = {\n    draft: { color: \"gray\", label: \"Utkast\" },\n    sent: { color: \"info\", label: \"Sendt\" },\n    paid: { color: \"success\", label: \"Betalt\" },\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          Fakturaer\n        </h1>\n        <p className=\"text-gray-500 dark:text-gray-400\">\n          {invoices.length} fakturaer totalt\n        </p>\n      </div>\n\n      <Card>\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableHeadCell>Faktura</TableHeadCell>\n              <TableHeadCell>Kunde</TableHeadCell>\n              <TableHeadCell>Dato</TableHeadCell>\n              <TableHeadCell>Forfall</TableHeadCell>\n              <TableHeadCell>Status</TableHeadCell>\n              <TableHeadCell className=\"text-right\">Belop</TableHeadCell>\n            </TableRow>\n          </TableHead>\n          <TableBody className=\"divide-y\">\n            {invoices.map((invoice) => {\n              const overdue = isOverdue(invoice);\n              return (\n                <TableRow\n                  key={invoice.id}\n                  className={overdue ? \"bg-red-50 dark:bg-red-900/20\" : \"bg-white dark:bg-gray-800\"}\n                >\n                  <TableCell className=\"font-medium text-gray-900 dark:text-white\">\n                    #{invoice.invoice_number}\n                  </TableCell>\n                  <TableCell>{invoice.customer_name || \"-\"}</TableCell>\n                  <TableCell className=\"text-gray-500\">{invoice.date}</TableCell>\n                  <TableCell className={overdue ? \"text-red-600 font-medium\" : \"text-gray-500\"}>\n                    {invoice.due_date}\n                  </TableCell>\n                  <TableCell>\n                    {overdue ? (\n                      <Badge color=\"failure\">Forfalt</Badge>\n                    ) : (\n                      <Badge color={statusConfig[invoice.status]?.color || \"gray\"}>\n                        {statusConfig[invoice.status]?.label || invoice.status}\n                      </Badge>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-medium text-gray-900 dark:text-white\">\n                    {formatCurrency(invoice.total)}\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAEO,MAAM,UAAU;AAYR,SAAS;IACtB,MAAM,WAAW,IAAA,oKAAW;IAE5B,MAAM,iBAAiB,CAAC;QACtB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;YACpC,OAAO;YACP,UAAU;YACV,uBAAuB;QACzB,GAAG,MAAM,CAAC,SAAS;IACrB;IAEA,MAAM,YAAY,CAAC;QACjB,OAAO,QAAQ,MAAM,KAAK,UAAU,IAAI,KAAK,QAAQ,QAAQ,IAAI,IAAI;IACvE;IAEA,MAAM,eAAkG;QACtG,OAAO;YAAE,OAAO;YAAQ,OAAO;QAAS;QACxC,MAAM;YAAE,OAAO;YAAQ,OAAO;QAAQ;QACtC,MAAM;YAAE,OAAO;YAAW,OAAO;QAAS;IAC5C;IAEA,qBACE,0RAAC;QAAI,WAAU;;0BACb,0RAAC;gBAAI,WAAU;;kCACb,0RAAC;wBAAG,WAAU;kCAAmD;;;;;;kCAGjE,0RAAC;wBAAE,WAAU;;4BACV,SAAS,MAAM;4BAAC;;;;;;;;;;;;;0BAIrB,0RAAC,2NAAI;0BACH,cAAA,0RAAC,8NAAK;;sCACJ,0RAAC,sOAAS;sCACR,cAAA,0RAAC,oOAAQ;;kDACP,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;wCAAC,WAAU;kDAAa;;;;;;;;;;;;;;;;;sCAG1C,0RAAC,sOAAS;4BAAC,WAAU;sCAClB,SAAS,GAAG,CAAC,CAAC;gCACb,MAAM,UAAU,UAAU;gCAC1B,qBACE,0RAAC,oOAAQ;oCAEP,WAAW,UAAU,iCAAiC;;sDAEtD,0RAAC,sOAAS;4CAAC,WAAU;;gDAA4C;gDAC7D,QAAQ,cAAc;;;;;;;sDAE1B,0RAAC,sOAAS;sDAAE,QAAQ,aAAa,IAAI;;;;;;sDACrC,0RAAC,sOAAS;4CAAC,WAAU;sDAAiB,QAAQ,IAAI;;;;;;sDAClD,0RAAC,sOAAS;4CAAC,WAAW,UAAU,6BAA6B;sDAC1D,QAAQ,QAAQ;;;;;;sDAEnB,0RAAC,sOAAS;sDACP,wBACC,0RAAC,8NAAK;gDAAC,OAAM;0DAAU;;;;;qEAEvB,0RAAC,8NAAK;gDAAC,OAAO,YAAY,CAAC,QAAQ,MAAM,CAAC,EAAE,SAAS;0DAClD,YAAY,CAAC,QAAQ,MAAM,CAAC,EAAE,SAAS,QAAQ,MAAM;;;;;;;;;;;sDAI5D,0RAAC,sOAAS;4CAAC,WAAU;sDAClB,eAAe,QAAQ,KAAK;;;;;;;mCArB1B,QAAQ,EAAE;;;;;4BAyBrB;;;;;;;;;;;;;;;;;;;;;;;AAMZ","debugId":null}}]
}