{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport path from 'path'\n\nconst dbPath = path.join(process.cwd(), '..', 'data', 'crm.db')\n\nexport function getDb() {\n  return new Database(dbPath, { readonly: true })\n}\n\nexport function getStats() {\n  const db = getDb()\n\n  const stats = db.prepare(`\n    SELECT\n      (SELECT COUNT(*) FROM customers) as total_customers,\n      (SELECT COUNT(*) FROM invoices) as total_invoices,\n      (SELECT COUNT(*) FROM projects) as total_projects,\n      (SELECT SUM(total) FROM invoices WHERE status = 'paid') as total_revenue,\n      (SELECT SUM(total) FROM invoices WHERE status = 'sent') as outstanding,\n      (SELECT COUNT(*) FROM invoices WHERE status <> 'paid' AND due_date < date('now')) as overdue_count\n  `).get() as any\n\n  db.close()\n  return stats\n}\n\nexport function getCustomers(limit = 100) {\n  const db = getDb()\n\n  const customers = db.prepare(`\n    SELECT\n      c.*,\n      (SELECT COUNT(*) FROM invoices WHERE customer_id = c.id) as invoice_count,\n      (SELECT SUM(total) FROM invoices WHERE customer_id = c.id AND status = 'paid') as total_revenue\n    FROM customers c\n    ORDER BY c.name\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return customers\n}\n\nexport function getCustomer(id: string) {\n  const db = getDb()\n\n  const customer = db.prepare(`SELECT * FROM customers WHERE id = ?`).get(id)\n\n  const invoices = db.prepare(`\n    SELECT * FROM invoices\n    WHERE customer_id = ?\n    ORDER BY date DESC\n  `).all(id)\n\n  db.close()\n  return { customer, invoices }\n}\n\nexport function getInvoices(limit = 100) {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    ORDER BY i.date DESC\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return invoices\n}\n\nexport function getOverdueInvoices() {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    WHERE i.status <> 'paid' AND i.due_date < date('now')\n    ORDER BY i.due_date ASC\n  `).all()\n\n  db.close()\n  return invoices\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,MAAM,QAAQ;AAE/C,SAAS;IACd,OAAO,IAAI,sIAAQ,CAAC,QAAQ;QAAE,UAAU;IAAK;AAC/C;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,QAAQ,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ1B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,aAAa,QAAQ,GAAG;IACtC,MAAM,KAAK;IAEX,MAAM,YAAY,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ9B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,YAAY,EAAU;IACpC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,oCAAoC,CAAC,EAAE,GAAG,CAAC;IAExE,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;EAI7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;QAAE;QAAU;IAAS;AAC9B;AAEO,SAAS,YAAY,QAAQ,GAAG;IACrC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/app/%28dashboard%29/overdue/page.tsx"],"sourcesContent":["import { getOverdueInvoices } from \"@/lib/db\";\nimport { Badge, Card, Table, TableBody, TableCell, TableHead, TableHeadCell, TableRow } from \"flowbite-react\";\nimport { HiCheckCircle, HiExclamation } from \"react-icons/hi\";\n\nexport const dynamic = \"force-dynamic\";\n\ninterface OverdueInvoice {\n  id: string;\n  invoice_number: string;\n  customer_name: string | null;\n  due_date: string;\n  total: number;\n}\n\nexport default function OverduePage() {\n  const invoices = getOverdueInvoices() as OverdueInvoice[];\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat(\"nb-NO\", {\n      style: \"currency\",\n      currency: \"NOK\",\n      minimumFractionDigits: 0,\n    }).format(amount / 100);\n  };\n\n  const totalOverdue = invoices.reduce((sum, inv) => sum + (inv.total || 0), 0);\n\n  const getDaysOverdue = (dueDate: string) => {\n    const due = new Date(dueDate);\n    const today = new Date();\n    return Math.floor((today.getTime() - due.getTime()) / (1000 * 60 * 60 * 24));\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          Forfalte fakturaer\n        </h1>\n        <p className=\"text-gray-500 dark:text-gray-400\">\n          {invoices.length} fakturaer, totalt {formatCurrency(totalOverdue)}\n        </p>\n      </div>\n\n      {invoices.length > 0 && (\n        <div className=\"mb-6 flex items-center gap-3 rounded-lg border border-yellow-200 bg-yellow-50 p-4 dark:border-yellow-800 dark:bg-yellow-900/20\">\n          <HiExclamation className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400\" />\n          <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n            <span className=\"font-medium\">Tips:</span> Bruk Claude Code for aa sende purringer:\n            <code className=\"ml-2 rounded bg-yellow-100 px-2 py-1 text-xs dark:bg-yellow-900\">\n              &quot;Send purring til alle med faktura over 30 dager&quot;\n            </code>\n          </p>\n        </div>\n      )}\n\n      {invoices.length === 0 && (\n        <Card>\n          <div className=\"py-8 text-center\">\n            <HiCheckCircle className=\"mx-auto h-12 w-12 text-green-400\" />\n            <h3 className=\"mt-4 text-lg font-medium text-green-900 dark:text-green-300\">\n              Ingen forfalte fakturaer!\n            </h3>\n            <p className=\"mt-2 text-sm text-green-600 dark:text-green-400\">\n              Alle fakturaer er betalt eller ikke forfalt ennaa.\n            </p>\n          </div>\n        </Card>\n      )}\n\n      {invoices.length > 0 && (\n        <Card>\n          <Table>\n            <TableHead className=\"bg-red-50 dark:bg-red-900/20\">\n              <TableRow>\n                <TableHeadCell className=\"text-red-700 dark:text-red-400\">Faktura</TableHeadCell>\n                <TableHeadCell className=\"text-red-700 dark:text-red-400\">Kunde</TableHeadCell>\n                <TableHeadCell className=\"text-red-700 dark:text-red-400\">Forfalt</TableHeadCell>\n                <TableHeadCell className=\"text-red-700 dark:text-red-400\">Dager</TableHeadCell>\n                <TableHeadCell className=\"text-right text-red-700 dark:text-red-400\">Belop</TableHeadCell>\n              </TableRow>\n            </TableHead>\n            <TableBody className=\"divide-y\">\n              {invoices.map((invoice) => {\n                const daysOverdue = getDaysOverdue(invoice.due_date);\n                return (\n                  <TableRow key={invoice.id} className=\"bg-white hover:bg-red-50 dark:bg-gray-800 dark:hover:bg-red-900/10\">\n                    <TableCell className=\"font-medium text-gray-900 dark:text-white\">\n                      #{invoice.invoice_number}\n                    </TableCell>\n                    <TableCell>{invoice.customer_name || \"-\"}</TableCell>\n                    <TableCell className=\"text-red-600\">{invoice.due_date}</TableCell>\n                    <TableCell>\n                      <Badge\n                        color={\n                          daysOverdue > 60\n                            ? \"failure\"\n                            : daysOverdue > 30\n                            ? \"warning\"\n                            : \"info\"\n                        }\n                      >\n                        {daysOverdue} dager\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-right font-bold text-red-600\">\n                      {formatCurrency(invoice.total)}\n                    </TableCell>\n                  </TableRow>\n                );\n              })}\n            </TableBody>\n          </Table>\n        </Card>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;AAEO,MAAM,UAAU;AAUR,SAAS;IACtB,MAAM,WAAW,IAAA,2KAAkB;IAEnC,MAAM,iBAAiB,CAAC;QACtB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;YACpC,OAAO;YACP,UAAU;YACV,uBAAuB;QACzB,GAAG,MAAM,CAAC,SAAS;IACrB;IAEA,MAAM,eAAe,SAAS,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,GAAG;IAE3E,MAAM,iBAAiB,CAAC;QACtB,MAAM,MAAM,IAAI,KAAK;QACrB,MAAM,QAAQ,IAAI;QAClB,OAAO,KAAK,KAAK,CAAC,CAAC,MAAM,OAAO,KAAK,IAAI,OAAO,EAAE,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;IAC5E;IAEA,qBACE,0RAAC;QAAI,WAAU;;0BACb,0RAAC;gBAAI,WAAU;;kCACb,0RAAC;wBAAG,WAAU;kCAAmD;;;;;;kCAGjE,0RAAC;wBAAE,WAAU;;4BACV,SAAS,MAAM;4BAAC;4BAAoB,eAAe;;;;;;;;;;;;;YAIvD,SAAS,MAAM,GAAG,mBACjB,0RAAC;gBAAI,WAAU;;kCACb,0RAAC,iNAAa;wBAAC,WAAU;;;;;;kCACzB,0RAAC;wBAAE,WAAU;;0CACX,0RAAC;gCAAK,WAAU;0CAAc;;;;;;4BAAY;0CAC1C,0RAAC;gCAAK,WAAU;0CAAkE;;;;;;;;;;;;;;;;;;YAOvF,SAAS,MAAM,KAAK,mBACnB,0RAAC,2NAAI;0BACH,cAAA,0RAAC;oBAAI,WAAU;;sCACb,0RAAC,iNAAa;4BAAC,WAAU;;;;;;sCACzB,0RAAC;4BAAG,WAAU;sCAA8D;;;;;;sCAG5E,0RAAC;4BAAE,WAAU;sCAAkD;;;;;;;;;;;;;;;;;YAOpE,SAAS,MAAM,GAAG,mBACjB,0RAAC,2NAAI;0BACH,cAAA,0RAAC,8NAAK;;sCACJ,0RAAC,sOAAS;4BAAC,WAAU;sCACnB,cAAA,0RAAC,oOAAQ;;kDACP,0RAAC,8OAAa;wCAAC,WAAU;kDAAiC;;;;;;kDAC1D,0RAAC,8OAAa;wCAAC,WAAU;kDAAiC;;;;;;kDAC1D,0RAAC,8OAAa;wCAAC,WAAU;kDAAiC;;;;;;kDAC1D,0RAAC,8OAAa;wCAAC,WAAU;kDAAiC;;;;;;kDAC1D,0RAAC,8OAAa;wCAAC,WAAU;kDAA4C;;;;;;;;;;;;;;;;;sCAGzE,0RAAC,sOAAS;4BAAC,WAAU;sCAClB,SAAS,GAAG,CAAC,CAAC;gCACb,MAAM,cAAc,eAAe,QAAQ,QAAQ;gCACnD,qBACE,0RAAC,oOAAQ;oCAAkB,WAAU;;sDACnC,0RAAC,sOAAS;4CAAC,WAAU;;gDAA4C;gDAC7D,QAAQ,cAAc;;;;;;;sDAE1B,0RAAC,sOAAS;sDAAE,QAAQ,aAAa,IAAI;;;;;;sDACrC,0RAAC,sOAAS;4CAAC,WAAU;sDAAgB,QAAQ,QAAQ;;;;;;sDACrD,0RAAC,sOAAS;sDACR,cAAA,0RAAC,8NAAK;gDACJ,OACE,cAAc,KACV,YACA,cAAc,KACd,YACA;;oDAGL;oDAAY;;;;;;;;;;;;sDAGjB,0RAAC,sOAAS;4CAAC,WAAU;sDAClB,eAAe,QAAQ,KAAK;;;;;;;mCApBlB,QAAQ,EAAE;;;;;4BAwB7B;;;;;;;;;;;;;;;;;;;;;;;AAOd","debugId":null}}]
}