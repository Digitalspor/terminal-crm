{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport path from 'path'\n\nconst dbPath = path.join(process.cwd(), '..', 'data', 'crm.db')\n\nexport function getDb() {\n  return new Database(dbPath, { readonly: true })\n}\n\nexport function getStats() {\n  const db = getDb()\n\n  const stats = db.prepare(`\n    SELECT\n      (SELECT COUNT(*) FROM customers) as total_customers,\n      (SELECT COUNT(*) FROM invoices) as total_invoices,\n      (SELECT COUNT(*) FROM projects) as total_projects,\n      (SELECT SUM(total) FROM invoices WHERE status = 'paid') as total_revenue,\n      (SELECT SUM(total) FROM invoices WHERE status = 'sent') as outstanding,\n      (SELECT COUNT(*) FROM invoices WHERE status <> 'paid' AND due_date < date('now')) as overdue_count\n  `).get() as any\n\n  db.close()\n  return stats\n}\n\nexport function getCustomers(limit = 100) {\n  const db = getDb()\n\n  const customers = db.prepare(`\n    SELECT\n      c.*,\n      (SELECT COUNT(*) FROM invoices WHERE customer_id = c.id) as invoice_count,\n      (SELECT SUM(total) FROM invoices WHERE customer_id = c.id AND status = 'paid') as total_revenue\n    FROM customers c\n    ORDER BY c.name\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return customers\n}\n\nexport function getCustomer(id: string) {\n  const db = getDb()\n\n  const customer = db.prepare(`SELECT * FROM customers WHERE id = ?`).get(id)\n\n  const invoices = db.prepare(`\n    SELECT * FROM invoices\n    WHERE customer_id = ?\n    ORDER BY date DESC\n  `).all(id)\n\n  db.close()\n  return { customer, invoices }\n}\n\nexport function getInvoices(limit = 100) {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    ORDER BY i.date DESC\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return invoices\n}\n\nexport function getOverdueInvoices() {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    WHERE i.status <> 'paid' AND i.due_date < date('now')\n    ORDER BY i.due_date ASC\n  `).all()\n\n  db.close()\n  return invoices\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,MAAM,QAAQ;AAE/C,SAAS;IACd,OAAO,IAAI,sIAAQ,CAAC,QAAQ;QAAE,UAAU;IAAK;AAC/C;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,QAAQ,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ1B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,aAAa,QAAQ,GAAG;IACtC,MAAM,KAAK;IAEX,MAAM,YAAY,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ9B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,YAAY,EAAU;IACpC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,oCAAoC,CAAC,EAAE,GAAG,CAAC;IAExE,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;EAI7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;QAAE;QAAU;IAAS;AAC9B;AAEO,SAAS,YAAY,QAAQ,GAAG;IACrC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/app/%28dashboard%29/dashboard/page.tsx"],"sourcesContent":["import { getStats, getOverdueInvoices } from \"@/lib/db\";\nimport { Badge, Card } from \"flowbite-react\";\nimport Link from \"next/link\";\nimport {\n  HiCurrencyDollar,\n  HiDocumentText,\n  HiExclamation,\n  HiUserGroup,\n} from \"react-icons/hi\";\n\nexport const dynamic = \"force-dynamic\";\n\ninterface Stats {\n  total_customers: number;\n  total_invoices: number;\n  total_projects: number;\n  total_revenue: number | null;\n  outstanding: number | null;\n  overdue_count: number;\n}\n\ninterface OverdueInvoice {\n  id: string;\n  invoice_number: string;\n  customer_name: string;\n  due_date: string;\n  total: number;\n}\n\nexport default function DashboardPage() {\n  const stats = getStats() as Stats;\n  const overdueInvoices = getOverdueInvoices() as OverdueInvoice[];\n\n  const formatCurrency = (amount: number | null) => {\n    if (amount === null || amount === undefined) return \"kr 0\";\n    return new Intl.NumberFormat(\"nb-NO\", {\n      style: \"currency\",\n      currency: \"NOK\",\n      minimumFractionDigits: 0,\n    }).format(amount / 100);\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          Dashboard\n        </h1>\n        <p className=\"text-gray-500 dark:text-gray-400\">\n          Oversikt over CRM-data\n        </p>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"mb-8 grid gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n        <StatCard\n          title=\"Kunder\"\n          value={stats.total_customers || 0}\n          icon={HiUserGroup}\n          color=\"blue\"\n        />\n        <StatCard\n          title=\"Fakturaer\"\n          value={stats.total_invoices || 0}\n          icon={HiDocumentText}\n          color=\"purple\"\n        />\n        <StatCard\n          title=\"Omsetning\"\n          value={formatCurrency(stats.total_revenue)}\n          icon={HiCurrencyDollar}\n          color=\"green\"\n        />\n        <StatCard\n          title=\"Forfalte\"\n          value={stats.overdue_count || 0}\n          icon={HiExclamation}\n          color=\"yellow\"\n          highlight={stats.overdue_count > 0}\n        />\n      </div>\n\n      {/* Overdue Invoices */}\n      {overdueInvoices.length > 0 && (\n        <Card>\n          <div className=\"flex items-center justify-between mb-4\">\n            <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n              Forfalte fakturaer\n            </h2>\n            <Link href=\"/overdue\">\n              <Badge color=\"failure\">Se alle</Badge>\n            </Link>\n          </div>\n          <div className=\"divide-y divide-gray-200 dark:divide-gray-700\">\n            {overdueInvoices.slice(0, 5).map((invoice) => (\n              <div\n                key={invoice.id}\n                className=\"flex items-center justify-between py-3\"\n              >\n                <div>\n                  <p className=\"font-medium text-gray-900 dark:text-white\">\n                    #{invoice.invoice_number}\n                  </p>\n                  <p className=\"text-sm text-gray-500\">\n                    {invoice.customer_name || \"Ukjent kunde\"}\n                  </p>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Badge color=\"failure\">{invoice.due_date}</Badge>\n                  <span className=\"font-bold text-red-600\">\n                    {formatCurrency(invoice.total)}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n\n      {overdueInvoices.length === 0 && (\n        <Card>\n          <div className=\"py-8 text-center\">\n            <HiExclamation className=\"mx-auto h-12 w-12 text-green-400\" />\n            <h3 className=\"mt-4 text-lg font-medium text-green-900 dark:text-green-300\">\n              Ingen forfalte fakturaer!\n            </h3>\n            <p className=\"mt-2 text-sm text-green-600 dark:text-green-400\">\n              Alle fakturaer er betalt eller ikke forfalt ennaa.\n            </p>\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n}\n\nfunction StatCard({\n  title,\n  value,\n  icon: Icon,\n  color,\n  highlight,\n}: {\n  title: string;\n  value: number | string;\n  icon: React.ComponentType<{ className?: string }>;\n  color: \"blue\" | \"green\" | \"yellow\" | \"purple\";\n  highlight?: boolean;\n}) {\n  const colors = {\n    blue: \"bg-blue-100 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400\",\n    green:\n      \"bg-green-100 text-green-600 dark:bg-green-900/20 dark:text-green-400\",\n    yellow:\n      \"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/20 dark:text-yellow-400\",\n    purple:\n      \"bg-purple-100 text-purple-600 dark:bg-purple-900/20 dark:text-purple-400\",\n  };\n\n  return (\n    <Card className={highlight ? \"ring-2 ring-yellow-400\" : \"\"}>\n      <div className=\"flex items-center gap-4\">\n        <div className={`rounded-lg p-3 ${colors[color]}`}>\n          <Icon className=\"size-6\" />\n        </div>\n        <div>\n          <p className=\"text-sm text-gray-500 dark:text-gray-400\">{title}</p>\n          <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n            {value}\n          </p>\n        </div>\n      </div>\n    </Card>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;;AAOO,MAAM,UAAU;AAmBR,SAAS;IACtB,MAAM,QAAQ,IAAA,iKAAQ;IACtB,MAAM,kBAAkB,IAAA,2KAAkB;IAE1C,MAAM,iBAAiB,CAAC;QACtB,IAAI,WAAW,QAAQ,WAAW,WAAW,OAAO;QACpD,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;YACpC,OAAO;YACP,UAAU;YACV,uBAAuB;QACzB,GAAG,MAAM,CAAC,SAAS;IACrB;IAEA,qBACE,0RAAC;QAAI,WAAU;;0BACb,0RAAC;gBAAI,WAAU;;kCACb,0RAAC;wBAAG,WAAU;kCAAmD;;;;;;kCAGjE,0RAAC;wBAAE,WAAU;kCAAmC;;;;;;;;;;;;0BAMlD,0RAAC;gBAAI,WAAU;;kCACb,0RAAC;wBACC,OAAM;wBACN,OAAO,MAAM,eAAe,IAAI;wBAChC,MAAM,+MAAW;wBACjB,OAAM;;;;;;kCAER,0RAAC;wBACC,OAAM;wBACN,OAAO,MAAM,cAAc,IAAI;wBAC/B,MAAM,kNAAc;wBACpB,OAAM;;;;;;kCAER,0RAAC;wBACC,OAAM;wBACN,OAAO,eAAe,MAAM,aAAa;wBACzC,MAAM,oNAAgB;wBACtB,OAAM;;;;;;kCAER,0RAAC;wBACC,OAAM;wBACN,OAAO,MAAM,aAAa,IAAI;wBAC9B,MAAM,iNAAa;wBACnB,OAAM;wBACN,WAAW,MAAM,aAAa,GAAG;;;;;;;;;;;;YAKpC,gBAAgB,MAAM,GAAG,mBACxB,0RAAC,2NAAI;;kCACH,0RAAC;wBAAI,WAAU;;0CACb,0RAAC;gCAAG,WAAU;0CAAsD;;;;;;0CAGpE,0RAAC,mNAAI;gCAAC,MAAK;0CACT,cAAA,0RAAC,8NAAK;oCAAC,OAAM;8CAAU;;;;;;;;;;;;;;;;;kCAG3B,0RAAC;wBAAI,WAAU;kCACZ,gBAAgB,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,wBAChC,0RAAC;gCAEC,WAAU;;kDAEV,0RAAC;;0DACC,0RAAC;gDAAE,WAAU;;oDAA4C;oDACrD,QAAQ,cAAc;;;;;;;0DAE1B,0RAAC;gDAAE,WAAU;0DACV,QAAQ,aAAa,IAAI;;;;;;;;;;;;kDAG9B,0RAAC;wCAAI,WAAU;;0DACb,0RAAC,8NAAK;gDAAC,OAAM;0DAAW,QAAQ,QAAQ;;;;;;0DACxC,0RAAC;gDAAK,WAAU;0DACb,eAAe,QAAQ,KAAK;;;;;;;;;;;;;+BAd5B,QAAQ,EAAE;;;;;;;;;;;;;;;;YAuBxB,gBAAgB,MAAM,KAAK,mBAC1B,0RAAC,2NAAI;0BACH,cAAA,0RAAC;oBAAI,WAAU;;sCACb,0RAAC,iNAAa;4BAAC,WAAU;;;;;;sCACzB,0RAAC;4BAAG,WAAU;sCAA8D;;;;;;sCAG5E,0RAAC;4BAAE,WAAU;sCAAkD;;;;;;;;;;;;;;;;;;;;;;;AAQ3E;AAEA,SAAS,SAAS,EAChB,KAAK,EACL,KAAK,EACL,MAAM,IAAI,EACV,KAAK,EACL,SAAS,EAOV;IACC,MAAM,SAAS;QACb,MAAM;QACN,OACE;QACF,QACE;QACF,QACE;IACJ;IAEA,qBACE,0RAAC,2NAAI;QAAC,WAAW,YAAY,2BAA2B;kBACtD,cAAA,0RAAC;YAAI,WAAU;;8BACb,0RAAC;oBAAI,WAAW,CAAC,eAAe,EAAE,MAAM,CAAC,MAAM,EAAE;8BAC/C,cAAA,0RAAC;wBAAK,WAAU;;;;;;;;;;;8BAElB,0RAAC;;sCACC,0RAAC;4BAAE,WAAU;sCAA4C;;;;;;sCACzD,0RAAC;4BAAE,WAAU;sCACV;;;;;;;;;;;;;;;;;;;;;;;AAMb","debugId":null}}]
}