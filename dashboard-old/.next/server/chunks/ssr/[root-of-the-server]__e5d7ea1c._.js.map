{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport path from 'path'\n\nconst dbPath = path.join(process.cwd(), '..', 'data', 'crm.db')\n\nexport function getDb() {\n  return new Database(dbPath, { readonly: true })\n}\n\nexport function getStats() {\n  const db = getDb()\n\n  const stats = db.prepare(`\n    SELECT\n      (SELECT COUNT(*) FROM customers) as total_customers,\n      (SELECT COUNT(*) FROM invoices) as total_invoices,\n      (SELECT COUNT(*) FROM projects) as total_projects,\n      (SELECT SUM(total) FROM invoices WHERE status = 'paid') as total_revenue,\n      (SELECT SUM(total) FROM invoices WHERE status = 'sent') as outstanding,\n      (SELECT COUNT(*) FROM invoices WHERE status <> 'paid' AND due_date < date('now')) as overdue_count\n  `).get() as any\n\n  db.close()\n  return stats\n}\n\nexport function getCustomers(limit = 100) {\n  const db = getDb()\n\n  const customers = db.prepare(`\n    SELECT\n      c.*,\n      (SELECT COUNT(*) FROM invoices WHERE customer_id = c.id) as invoice_count,\n      (SELECT SUM(total) FROM invoices WHERE customer_id = c.id AND status = 'paid') as total_revenue\n    FROM customers c\n    ORDER BY c.name\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return customers\n}\n\nexport function getCustomer(id: string) {\n  const db = getDb()\n\n  const customer = db.prepare(`SELECT * FROM customers WHERE id = ?`).get(id)\n\n  const invoices = db.prepare(`\n    SELECT * FROM invoices\n    WHERE customer_id = ?\n    ORDER BY date DESC\n  `).all(id)\n\n  db.close()\n  return { customer, invoices }\n}\n\nexport function getInvoices(limit = 100) {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    ORDER BY i.date DESC\n    LIMIT ?\n  `).all(limit)\n\n  db.close()\n  return invoices\n}\n\nexport function getOverdueInvoices() {\n  const db = getDb()\n\n  const invoices = db.prepare(`\n    SELECT\n      i.*,\n      c.name as customer_name\n    FROM invoices i\n    LEFT JOIN customers c ON i.customer_id = c.id\n    WHERE i.status <> 'paid' AND i.due_date < date('now')\n    ORDER BY i.due_date ASC\n  `).all()\n\n  db.close()\n  return invoices\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,MAAM,QAAQ;AAE/C,SAAS;IACd,OAAO,IAAI,sIAAQ,CAAC,QAAQ;QAAE,UAAU;IAAK;AAC/C;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,QAAQ,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ1B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,aAAa,QAAQ,GAAG;IACtC,MAAM,KAAK;IAEX,MAAM,YAAY,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ9B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS,YAAY,EAAU;IACpC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,oCAAoC,CAAC,EAAE,GAAG,CAAC;IAExE,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;EAI7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;QAAE;QAAU;IAAS;AAC9B;AAEO,SAAS,YAAY,QAAQ,GAAG;IACrC,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG,CAAC;IAEP,GAAG,KAAK;IACR,OAAO;AACT;AAEO,SAAS;IACd,MAAM,KAAK;IAEX,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC;;;;;;;;EAQ7B,CAAC,EAAE,GAAG;IAEN,GAAG,KAAK;IACR,OAAO;AACT","debugId":null}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/andrecollier/Personal/crm-terminal/dashboard/app/%28dashboard%29/customers/page.tsx"],"sourcesContent":["import { getCustomers } from \"@/lib/db\";\nimport { Badge, Card, Table, TableBody, TableCell, TableHead, TableHeadCell, TableRow } from \"flowbite-react\";\nimport Link from \"next/link\";\n\nexport const dynamic = \"force-dynamic\";\n\ninterface Customer {\n  id: string;\n  name: string;\n  org_nr: string | null;\n  contact_email: string | null;\n  contact_phone: string | null;\n  address_city: string | null;\n  invoice_count: number;\n  total_revenue: number | null;\n}\n\nexport default function CustomersPage() {\n  const customers = getCustomers() as Customer[];\n\n  const formatCurrency = (amount: number | null) => {\n    if (!amount) return \"-\";\n    return new Intl.NumberFormat(\"nb-NO\", {\n      style: \"currency\",\n      currency: \"NOK\",\n      minimumFractionDigits: 0,\n    }).format(amount / 100);\n  };\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n          Kunder\n        </h1>\n        <p className=\"text-gray-500 dark:text-gray-400\">\n          {customers.length} kunder totalt\n        </p>\n      </div>\n\n      <Card>\n        <Table>\n          <TableHead>\n            <TableRow>\n              <TableHeadCell>Kunde</TableHeadCell>\n              <TableHeadCell>Kontakt</TableHeadCell>\n              <TableHeadCell>By</TableHeadCell>\n              <TableHeadCell className=\"text-right\">Fakturaer</TableHeadCell>\n              <TableHeadCell className=\"text-right\">Omsetning</TableHeadCell>\n            </TableRow>\n          </TableHead>\n          <TableBody className=\"divide-y\">\n            {customers.map((customer) => (\n              <TableRow key={customer.id} className=\"bg-white dark:bg-gray-800\">\n                <TableCell>\n                  <Link\n                    href={`/customers/${customer.id}`}\n                    className=\"font-medium text-blue-600 hover:underline dark:text-blue-400\"\n                  >\n                    {customer.name}\n                  </Link>\n                  {customer.org_nr && (\n                    <p className=\"text-sm text-gray-500\">{customer.org_nr}</p>\n                  )}\n                </TableCell>\n                <TableCell>\n                  <p className=\"text-gray-900 dark:text-white\">\n                    {customer.contact_email || \"-\"}\n                  </p>\n                  <p className=\"text-sm text-gray-500\">\n                    {customer.contact_phone || \"\"}\n                  </p>\n                </TableCell>\n                <TableCell className=\"text-gray-500\">\n                  {customer.address_city || \"-\"}\n                </TableCell>\n                <TableCell className=\"text-right\">\n                  <Badge color=\"info\">{customer.invoice_count || 0}</Badge>\n                </TableCell>\n                <TableCell className=\"text-right font-medium text-gray-900 dark:text-white\">\n                  {formatCurrency(customer.total_revenue)}\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;AAEO,MAAM,UAAU;AAaR,SAAS;IACtB,MAAM,YAAY,IAAA,qKAAY;IAE9B,MAAM,iBAAiB,CAAC;QACtB,IAAI,CAAC,QAAQ,OAAO;QACpB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;YACpC,OAAO;YACP,UAAU;YACV,uBAAuB;QACzB,GAAG,MAAM,CAAC,SAAS;IACrB;IAEA,qBACE,0RAAC;QAAI,WAAU;;0BACb,0RAAC;gBAAI,WAAU;;kCACb,0RAAC;wBAAG,WAAU;kCAAmD;;;;;;kCAGjE,0RAAC;wBAAE,WAAU;;4BACV,UAAU,MAAM;4BAAC;;;;;;;;;;;;;0BAItB,0RAAC,2NAAI;0BACH,cAAA,0RAAC,8NAAK;;sCACJ,0RAAC,sOAAS;sCACR,cAAA,0RAAC,oOAAQ;;kDACP,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;kDAAC;;;;;;kDACf,0RAAC,8OAAa;wCAAC,WAAU;kDAAa;;;;;;kDACtC,0RAAC,8OAAa;wCAAC,WAAU;kDAAa;;;;;;;;;;;;;;;;;sCAG1C,0RAAC,sOAAS;4BAAC,WAAU;sCAClB,UAAU,GAAG,CAAC,CAAC,yBACd,0RAAC,oOAAQ;oCAAmB,WAAU;;sDACpC,0RAAC,sOAAS;;8DACR,0RAAC,mNAAI;oDACH,MAAM,CAAC,WAAW,EAAE,SAAS,EAAE,EAAE;oDACjC,WAAU;8DAET,SAAS,IAAI;;;;;;gDAEf,SAAS,MAAM,kBACd,0RAAC;oDAAE,WAAU;8DAAyB,SAAS,MAAM;;;;;;;;;;;;sDAGzD,0RAAC,sOAAS;;8DACR,0RAAC;oDAAE,WAAU;8DACV,SAAS,aAAa,IAAI;;;;;;8DAE7B,0RAAC;oDAAE,WAAU;8DACV,SAAS,aAAa,IAAI;;;;;;;;;;;;sDAG/B,0RAAC,sOAAS;4CAAC,WAAU;sDAClB,SAAS,YAAY,IAAI;;;;;;sDAE5B,0RAAC,sOAAS;4CAAC,WAAU;sDACnB,cAAA,0RAAC,8NAAK;gDAAC,OAAM;0DAAQ,SAAS,aAAa,IAAI;;;;;;;;;;;sDAEjD,0RAAC,sOAAS;4CAAC,WAAU;sDAClB,eAAe,SAAS,aAAa;;;;;;;mCA3B3B,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCxC","debugId":null}}]
}